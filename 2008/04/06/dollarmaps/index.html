<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>DollarMaps: Easy Map Creation for Java</title>
    <link rel="stylesheet" type="text/css" href="/style.css">
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38858050-1']);
      _gaq.push(['_trackPageview']);
      (function() {
       var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
       ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
       var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();
    </script>
  </head>
  <body>
    <div class="body">
      <div class="header">
        <div class="title">
          <a href="/">Robbie&#39;s Garbage, Collected.</a>
        </div>
      </div>
      <div class="blog">
        <h1>DollarMaps: Easy Map Creation for Java</h1>
        <div class="date">April 6, 2008</div>
        <div class="entry">Inspired by <a href="http://timepedia.blogspot.com/2008/04/gwt-road-to-15-language-features-and.html">GQuery</a>'s syntax,Â  I hacked up some code that uses a similar, dollar sign based syntax for creating Java Map instances. And I have to say that it flows really nicely. But first, let's "respect the classics" .<br><pre><br>Map&lt;Integer, String&gt; map = new HashMap&lt;Integer, String&gt;();<br>map.put(1, "one");<br>map.put(2, "two");<br>map.put(3, "three");<br><br>// iterate over all the entries<br>for (Entry&lt;Integer, String&gt; e : map.entrySet())<br>    System.out.println(e.getKey() + " " + e.getValue());<br></pre><br>So, there are three things to notice here.<br><ul><br>	<li>The repeated type parameters on the first line</li><br>        <li>Having to use three lines of extra code to get the items in</li><br>        <li>Having to use getKey() and getValue() in the iteration</li><br></ul><br>If you didn't know yet, most of these issues can be solved by using <a href="http://code.google.com/p/google-collections/">Google Collections</a>. But besides that, I think the dollar sign based syntax, which I called DollarMaps, is slightly more elegant than the usual "let's-do-some-type-inference" factory method.<br>Creating a HashMap:<br><pre><br>        Map&lt;Integer, String&gt; map = $(1,"blah1")<br>                                  .$(2, "blah2")<br>                                  .$(3, "blah3").asHashMap();<br></pre><br>Iteration:<br><pre><br>        for(Entry&lt;Integer, String&gt; e : $(1,"blah1").$(2, "blah2")) {<br>            System.out.println(e.getKey() + " " + e.getValue());<br>        }<br></pre><br>You can even take iteration further if both the key and the value have the same type. I tried some things out and came up with the double dollar sign syntax to enforce that type rule. So easier, array-based iteration:<br><pre><br>        for(String[] s : $$("1","blah1").$("2", "blah2").asEasy()) {<br>            System.out.println(s[0] + " " + s[1]);<br>        }<br></pre><br>I did not run any performance tests (I am creating a 2-element array for each entry).<br>Anyway, I'll have this up for grabs at my <a href="http://code.google.com/p/garbagecollected/">Google Code project</a>. For the impatient, here's the <a href="http://garbagecollected.googlecode.com/svn/trunk/DollarMaps/dist/DollarMaps-snapshot.zip">download link</a>. Feedback appreciated!</div>
      </div>
    </div>
  </body>
</html>
